--201.파견직_급여이력조회
--작성일자 : 2008.02.18 
/* 인수로 조회를 원하는 지급년월 기간을  입력한다.*/
/* 급여이력에서 개인별 지급항목 리스트.(정보검색에 적용)-일반 */

SELECT PAYDATE 지급년월, empno 사번, korname 성명,
       NVL(FIXPAY      ,0) 월정급여       ,
       NVL(QUATERPAY   ,0) 분기급여       ,
       NVL(HOLIPAY     ,0) 명절급여       ,
       NVL(ROLEAMT     ,0) 직책수당       ,
       NVL( MATEAMT    ,0) 가족수당_배우자,
       NVL( PARTAMT    ,0) 가족수당_존속  ,
       NVL( CHILDAMT   ,0) 가족수당_비속  ,
       NVL( LICEAMT    ,0) 자격수당       ,
       NVL( OVTMAMT    ,0) 초과근무수당   ,
       NVL( SPTMAMT    ,0) 특별근무수당   ,
       NVL( AIDAMT1    ,0) 기타수당1      ,
       NVL( AIDAMT2    ,0) 기타수당2      ,
       NVL( AIDAMT3    ,0) "유치수수료(2006년이후)",
       NVL( BONUSAMT   ,0) 정기상여금     ,
       NVL( INCENTAMT  ,0) 능률제고수당   ,
       NVL( TRAINAMT   ,0) 체력단련비     ,
       NVL( WINTERAMT  ,0) 영업인센티브   ,
       NVL( SBONAMT    ,0) 특상           ,
       NVL( MBONAMT    ,0) 월차수당       ,
       NVL( ITAMT      ,0) 정보통신수당   ,/*200501신설*/
       NVL( YBONAMT    ,0) 연차           ,
       NVL( MCARAMT    ,0) 식대교통비     ,
       NVL( YUEDUAMT   ,0) 학자금_유치원  ,
       NVL( SELFEDUAMT ,0) 학자금_본인    ,
       NVL( ODAMT      ,0) 운전지원금총액 ,
       NVL( ODTAXAMT   ,0) 운전지원금_과세총액 ,
       NVL( DRVLICEAMT ,0) 운전면허지원금 ,
       NVL( LECTSUPAMT ,0) 사내강사료     ,
       NVL( EDUSUPAMT  ,0) 교육비지원금   ,
       NVL( BOKJISUPAMT,0) 지급복지연금   ,
       NVL( MEDSUPAMT  ,0) 의료비지원금   ,
       NVL( HOMESUPAMT ,0) 선택적복리후생비,
       NVL( LONGSUPAMT ,0) 장기휴가비     ,
       NVL( SUPAMT1    ,0) 기타지원금1    ,
       NVL( SUPAMT2    ,0) 기타지원금2    ,
       NVL( SUPAMT3    ,0) 기타지원금3    ,
       NVL( SOPAYSUM   ,0) 소급급여       ,
       NVL( SOBONSUM   ,0) 소급상여       ,
       NVL( OVMCAMT    ,0) 야근식대       ,
       NVL( CHILDEDUAMT,0) 자녀학자금     ,
       NVL( MEDPAYAMT  ,0) 의료비지원금   ,
       NVL( NOTAXPAY   ,0) 기타비과세급여 ,
       NVL( TAXPAY     ,0) 기타과세급여   ,
       NVL( TRAINSUPAMT,0) 체육활동지원금 ,
       PAYSUM              지급총액        ,
       NVL(SAVEAMT1   ,0) 재형저축        ,
       NVL(SAVEAMT2   ,0) 장기저축        ,
       NVL(SAVEAMT3   ,0) 공제복지연금    ,
       NVL(MEDDAMT    ,0) 건강보험료공제금,
       NVL(EMPLDAMT   ,0) 고용보험료공제금,
       NVL(ANUDAMT    ,0) 국민연금갹출료  ,
       NVL(HSAMT      ,0) 주택자금대출    ,
       NVL(FBAMT      ,0) 외환복지대출    ,
       NVL(NBAMT      ,0) 국제화재대출    ,
       NVL(SACORPAMT  ,0) 사주회사대출    ,
       NVL(SABANKAMT  ,0) 사주은행대출    ,
       NVL(SANGAMT    ,0) 상조회대출      ,
       NVL(LOANAMT1   ,0) 기타대출1       ,
       NVL(LOANAMT2   ,0) 기타대출2       ,
       NVL(LOANAMT3   ,0) 기타대출3       ,
       NVL(TICKETAMT  ,0) 사용식권금액    ,
       NVL(OVMCDED    ,0) 석식공제금      ,
       NVL(NOJOAMT    ,0) 노조회비공제금  ,
       NVL(SAUAMT     ,0) 사우회비공제금  ,
       NVL(IGAMT      ,0) IG회비공제금    ,
       NVL(SOBIAMT    ,0) 소비조합할부금  ,
       NVL(PARKAMT    ,0) 주차비공제금    ,
       NVL(CHOLLAMT   ,0) 천리안이용료    ,
       NVL(EDUDEDAMT  ,0) 교육비공제금    ,
       NVL(MEDDEDAMT  ,0) 의료비가불공제금,
       NVL(DEDAMT1    ,0) 기타공제1       ,
       NVL(DEDAMT2    ,0) 기타공제2       ,
       NVL(DEDAMT3    ,0) 기타공제3       ,
       NVL(DEDAMT4    ,0) 기타공제4       ,
       NVL(DEDAMT5    ,0) 기타공제5       ,
       NVL(BONDEDAMT  ,0) 기지급상여금    ,
       NVL(PAYHOLDAMT ,0) 급여압류액      ,
       NVL(INTAX      ,0) 소득세          ,
       NVL(JUTAX      ,0) 주민세          ,
       NVL(DEDSUM, 0)     공제총액        ,
       REALPAY            실지급액
  FROM PKHPHIS
 WHERE EMPNO like 'Y%' 
   AND PAYDATE  BETWEEN  :From지급년월 AND :To지급년월
	   
	   
--202.파견직_당월급여조회
SELECT C.empno 		   		사번, 
	   C.korname 			성명, 
	   M.EMPDATE			입사일,
	   M.RETDATE		    퇴사일,
	   (select deptname from pycdept
	     where orgnum = C.orgnum and deptcode = C.deptcode) 소속부서,
	   NVL(Y.TOTPAY     ,0) 총연봉	  	   ,					   
       NVL(C.FIXPAY     ,0) 월정연봉       ,
       NVL(C.MCARAMT    ,0) 식대교통비     ,
	   NVL(C.AIDAMT1    ,0) 기타수당1      ,
       NVL(C.OVTMAMT    ,0) 초과수당계   ,
 	   NVL(O.EXTHH      ,0) 연장시간,
 	   NVL(O.NIGHTHH    ,0) 야간시간,
 	   NVL(O.HOLIHH     ,0) 휴일시간,
 	   NVL(O.EXTAMT     ,0) 연장수당,
 	   NVL(O.NIGHTAMT   ,0) 야간수당,
 	   NVL(O.HOLIAMT    ,0) 휴일수당,
 	   NVL(O.EXCEPHH    ,0) 제외시간,
 	   NVL(O.EXCEPAMT   ,0) 제외수당,	   	   
 	   NVL(O.OVMCAMT/3500,0) 야간식대일수,	   
 	   NVL(O.OVMCAMT    ,0) 야간식대금액,
       NVL(C.AIDAMT3    ,0) 유치수수료,	   
       NVL(C.HOMESUPAMT ,0) 선택적복리후생,
       NVL(C.SOPAYSUM   ,0) 소급급여합       ,
       NVL(C.YBONAMT    ,0) 연차수당           ,
       NVL(C.TAXPAY1    ,0) 기타과세급여1          ,
       NVL(C.TAXPAY2    ,0) 기타과세급여2          ,
       NVL(C.TAXPAY3    ,0) 기타과세급여3          ,
       NVL(C.TAXPAY4    ,0) 기타과세급여4          ,	 
       NVL(C.NOTAXPAY1  ,0) 관리수수료          ,	   
       NVL(C.MEDDAMT    ,0) 건강보험료,
       NVL(C.ANUDAMT    ,0) 국민연금료  ,
       NVL(C.EMPLDAMT   ,0) 고용보험료,
       NVL(C.DEDAMT1    ,0) 산재보험료
   FROM  PKMPCALC C, PKMPMAS M, PKHYPHIS Y,
 	   (
		SELECT EMPNO, 
			   SUBSTR(OVTMDATE,1,6) 	 OVYYYYMM,
			   SUM(NVL(OVTMAMT,0)) 	 	 OVTMAMT , 
			   SUM(NVL(EXTHH,0)) 		 EXTHH ,
		 	   SUM(NVL(NIGHTHH,0)) 		 NIGHTHH ,
		 	   SUM(NVL(HOLIHH,0)) 		 HOLIHH ,
		 	   SUM(NVL(EXTAMT,0)) 		 EXTAMT ,
		 	   SUM(NVL(NIGHTAMT,0)) 	 NIGHTAMT ,
		 	   SUM(NVL(HOLIAMT,0)) 		 HOLIAMT ,
		 	   SUM(NVL(EXCEPHH+MEALHH,0))		 EXCEPHH,
		 	   SUM(NVL(EXCEPAMT+MEALAMT,0))		 EXCEPAMT,	   
  			   SUM(NVL(OVMCAMT,0)) 		 OVMCAMT 
			FROM PKHOTHIS  
		WHERE EMPNO LIKE 'Y%'
		GROUP BY EMPNO,SUBSTR(OVTMDATE,1,6)
		) O
  WHERE C.EMPNO like 'Y%'
    AND C.EMPNO = M.EMPNO 
    AND C.EMPNO = Y.EMPNO
    AND M.YEARPAYNUM = Y.YEARPAYNUM
    AND C.EMPNO = O.EMPNO(+)
    AND O.OVYYYYMM(+)  = TO_CHAR(ADD_MONTHS(TO_DATE(C.PAYDATE,'YYYYMM'),-1),'YYYYMM')
  ORDER BY C.empno, C.Korname

--203.파견직_통합전 급여데이터
select PAYDATE 지급년월,
       EMPNO		    "사번",
       KORNAME		  "성명",
       BASICAMT	    "기준월급여",
       MONPAYAMT	  "월급여",
       MONBONAMT	  "월상여",
       MONRETAMT	  "월퇴중",
       MONINDAMT	  "간접비",
       COMPANYPAY	  "월용역비",
       BONUSAMT	    "상여",
       PERSONPAY	  "직접급여",
       TOTMM	      "총근무시간(분)",
       RESTMM	      "휴식시간(분)",
       BASEHH	      "기본근로시간",
       EXTHH	      "연장근로시간",
       NIGHTHH	    "야간근로시간",
       HOLIHH	      "휴일근로시간",
       HOLIEXTHH	  "휴일연장근로시간",
       BASEAMT	    "기본근로금액",
       EXTAMT	      "연장근로금액",
       NIGHTAMT	    "야간근로금액",
       HOLIAMT	    "휴일근로금액",
       HOLIEXTAMT	  "휴일연장근로금액",
       NOPAYCNT	    "급여공제일수",
       MCARDD	      "중식비지급일수",
       NIGHTMEALDD  "야근식대지급일수",
       MCARAMT	    "중식비",
       NIGHTMEALAMT	"야근식대",
       SELFDEVAMT	  "자기계발비",
       ATTRFEEAMT	  "유치수수료",
       ETCTAXAMT	  "기타과세(특이지급)",
       COMPAYSUM	  "용역비총계",
       PERPAYSUM	  "직접급여총계",
       COMDEDSUM	  "용역공제계",
       PERDEDSUM	  "직접공제계",
       COMREALPAY	  "실지급용역비",
       PERREALPAY	  "실지급직접비",
       RESTAMT	    "초과근무제외금액1",
       SPRESTAMT	  "초과근무제외금액2",
       MEALAMT	    "제외식사금액",
       EXCEPAMT	    "제외9이상금액",
       MEALHH	      "제외식사시간",
       EXCEPHH	    "제외9이상시간",
       WRITEMAN	    "최종작업자",
       WRITETIME	  "최종작업시간"       
  FROM PKHIGPAY  
 WHERE PAYDATE > '200800'


--211.단기계약 급여지급내역
SELECT P.PAYDATE     지급년월일,
       H.EMPNO       사번,  H.KORNAME 성명, 
       H.CONFRDATE   계약일자FR, 
       H.CONTODATE   계약일자TO, 
       H.JUMINID     주민번호, 
       H.SEX         성별, 
       H.ADDR        주소, 
       H.CELLTEL     전화번호, 
       H.SCHLNM      최종학교명,     
       P.PAYDATE     급여지급월, 
      (SELECT COUNT(DUCODE) FROM PKHILDUTY d  
        WHERE D.EMPNO   = P.EMPNO  
		  AND D.PAYDATE = P.PAYDATE  
		  AND DUCODE    = '00') 근무일수,	   
       P.TAXPAYSUM   과세급여합, 
       P.NOTAXPAYSUM 비과세급여합, 
       P.INTAX       소득세, 
       P.JUTAX       주민세, 
       P.MEDDAMT     국민건강보험, 
       P.EMPLDAMT    고용보험, 
       P.PAYSUM      지급총액, 
       P.DEDSUM      공제총액, 
       P.REALPAY     실지급액 
  FROM PKHILHIS H, PKHILPAY P  
 WHERE H.EMPNO  = P.EMPNO 
   AND Substr(P.PAYDATE,1,6) BETWEEN :지급월Fr AND :지급월To
 Order By P.PAYDATE, H.Empno
