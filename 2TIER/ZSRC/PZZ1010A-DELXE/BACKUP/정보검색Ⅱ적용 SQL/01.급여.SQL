--001.최종연봉 데이터 읽어오기
--최종연봉 데이터 읽어오기..(연봉업데이트 완료 후)
  SELECT C.EMPNO    사원번호,  C.KORNAME    성명,
         C.DEPTCODE 부서코드,  
         DECODE(D.DEPTNA3,'',D.DEPTNAME,D.DEPTNAME||'-'||D.DEPTNA3)   부서명,  
         C.PAYCL    BAND,  
        (SELECT CODENAME FROM PYCCODE WHERE CODEID = 'I112' AND CODENO=C.PAYCL) BAND명,
         C.PAYRA    직책,
        (SELECT CODENAME FROM PYCCODE WHERE CODEID = 'I113' AND CODENO=C.PAYRA) 직책명,
         C.PSTATE   인사상태,   
        (SELECT CODENAME FROM PYCCODE WHERE CODEID = 'I114' AND CODENO=C.PSTATE) 인사상태명,		                 
         C.ORGEMPDATE SKB입사일,
		 C.ORGEMPDATE 최초입사일,  
         B.YEARPAYNUM 급여연봉차수,  
         B.TOTPAY     총연봉,       
         CEIL(B.TOTPAY/18) "월정연봉1-총연봉/18",           
         C.FIXPAY          "월정연봉2-급여마스터월정연봉",
         BASEPAY      기본연봉, 
         ABLITYPAY    업적연봉
    FROM PKHYPHIS B, PKMPMAS C, PYCDEPT D
   WHERE B.EMPNO      = C.EMPNO
     AND B.YEARPAYNUM = (SELECT YEARPAYNUM FROM PKCPBAS)
     AND C.PSTATE     < '80'	 
     AND C.ORGNUM     = D.ORGNUM
     AND C.DEPTCODE   = D.DEPTCODE
   Order By C.Empno	 

--002.급여작업전 인원체크하기.
--각 사원번호 체계별로 급여 지급자 인원 체크
SELECT DECODE(SUBSTR(EMPNO,1,1),'2','0','1','0', SUBSTR(EMPNO,1,1)) "0-정규,M-임원,JPQ-계약,Y-파견",
       COUNT(*) 인원수  
  FROM PKMPMAS WHERE PAYYN = 'Y'
 GROUP BY DECODE(SUBSTR(EMPNO,1,1),'2','0','1','0', SUBSTR(EMPNO,1,1)) 

--003.연차수당
SELECT WORKYY 지급년도,  EMPNO 사번,  KORNAME 성명, REALAMT 실지급액
  FROM PKHYEHIS 
 WHERE WORKYY =:지급년도
	  
--004.개인별 항목별Sum 급여통계(급여이력에서)_1명씩
/* 인수로 조회를 원하는 지급년월 기간을  입력한다.*/ 
SELECT empno 사번, korname 성명,  Count(*) 인원,
       SUM(NVL(FIXPAY      ,0)) 월정급여       ,
       SUM(NVL(QUATERPAY   ,0)) 분기급여       ,
       SUM(NVL(HOLIPAY     ,0)) 명절급여       ,
       SUM(NVL(ROLEAMT     ,0)) 직책수당       ,
       SUM(NVL( MATEAMT    ,0)) 가족수당_배우자,
       SUM(NVL( PARTAMT    ,0)) 가족수당_존속  ,
       SUM(NVL( CHILDAMT   ,0)) 가족수당_비속  ,
       SUM(NVL( LICEAMT    ,0)) 자격수당       ,
       SUM(NVL( OVTMAMT    ,0)) 초과근무수당   ,
       SUM(NVL( SPTMAMT    ,0)) 특별근무수당   ,
       SUM(NVL( AIDAMT1    ,0)) 기타수당1      ,
       SUM(NVL( AIDAMT2    ,0)) 기타수당2      ,
       SUM(NVL( AIDAMT3    ,0)) "유치수수료(2006년이후)",
       SUM(NVL( BONUSAMT   ,0)) 정기상여금     , 
       SUM(NVL( INCENTAMT  ,0)) 능률제고수당   , 
       SUM(NVL( TRAINAMT   ,0)) 체력단련비     , 
       SUM(NVL( WINTERAMT  ,0)) 영업인센티브   ,
       SUM(NVL( SBONAMT    ,0)) 특상           ,
       SUM(NVL( MBONAMT    ,0)) 월차수당       ,
       SUM(NVL( ITAMT      ,0)) 정보통신수당   ,/*200501신설*/
       SUM(NVL( YBONAMT    ,0)) 연차           ,
       SUM(NVL( MCARAMT    ,0)) 식대교통비     ,
       SUM(NVL( MCARTAXAMT ,0)) 식대교통비_과세 ,
       SUM(NVL( YUEDUAMT   ,0)) 학자금_유치원  , 
       SUM(NVL( SELFEDUAMT ,0)) 학자금_본인    ,
       SUM(NVL( ODAMT      ,0)) 운전지원금총액 ,
       SUM(NVL( ODTAXAMT   ,0)) 운전지원금_과세총액 , 
       SUM(NVL( DRVLICEAMT ,0)) 운전면허지원금 ,
       SUM(NVL( LECTSUPAMT ,0)) 사내강사료     ,
       SUM(NVL( EDUSUPAMT  ,0)) 교육비지원금   ,
       SUM(NVL( BOKJISUPAMT,0)) 지급복지연금   ,  
       SUM(NVL( MEDSUPAMT  ,0)) 의료비지원금   ,
       SUM(NVL( HOMESUPAMT ,0)) 선택적복리후생비,
       SUM(NVL( LONGSUPAMT ,0)) 장기휴가비     ,
       SUM(NVL( SUPAMT1    ,0)) 기타지원금1    ,
       SUM(NVL( SUPAMT2    ,0)) 기타지원금2    ,
       SUM(NVL( SUPAMT3    ,0)) 기타지원금3    ,
       SUM(NVL( SOPAYSUM   ,0)) 소급급여       ,
       SUM(NVL( SOBONSUM   ,0)) 소급상여       ,
       SUM(NVL( OVMCAMT    ,0)) 야근식대       ,
       SUM(NVL( CHILDEDUAMT,0)) 자녀학자금     ,
       SUM(NVL( MEDPAYAMT  ,0)) 의료비지원금   ,
       SUM(NVL( NOTAXPAY   ,0)) 기타비과세급여 ,
       SUM(NVL( TAXPAY     ,0)) 기타과세급여   ,
       SUM(NVL( TRAINSUPAMT,0)) 체육활동지원금 ,
       SUM(PAYSUM)             지급총액        ,
       SUM(NVL(SAVEAMT1   ,0)) 재형저축        ,
       SUM(NVL(SAVEAMT2   ,0)) 장기저축        ,
       SUM(NVL(SAVEAMT3   ,0)) 공제복지연금    ,
       SUM(NVL(MEDDAMT    ,0)) 건강보험료공제금,
       SUM(NVL(EMPLDAMT   ,0)) 고용보험료공제금,
       SUM(NVL(ANUDAMT    ,0)) 국민연금갹출료  ,
       SUM(NVL(HSAMT      ,0)) 주택자금대출    ,
       SUM(NVL(FBAMT      ,0)) 외환복지대출    ,
       SUM(NVL(NBAMT      ,0)) 국제화재대출    ,
       SUM(NVL(SACORPAMT  ,0)) 사주회사대출    ,
       SUM(NVL(SABANKAMT  ,0)) 사주은행대출    ,
       SUM(NVL(SANGAMT    ,0)) 상조회대출      ,
       SUM(NVL(LOANAMT1   ,0)) 기타대출1       ,
       SUM(NVL(LOANAMT2   ,0)) 기타대출2       ,
       SUM(NVL(LOANAMT3   ,0)) 기타대출3       ,
       SUM(NVL(TICKETAMT  ,0)) 사용식권금액    ,
       SUM(NVL(OVMCDED    ,0)) 석식공제금      ,
       SUM(NVL(NOJOAMT    ,0)) 노조회비공제금  ,
       SUM(NVL(SAUAMT     ,0)) 사우회비공제금  ,
       SUM(NVL(IGAMT      ,0)) IG회비공제금    ,
       SUM(NVL(SOBIAMT    ,0)) 소비조합할부금  ,
       SUM(NVL(PARKAMT    ,0)) 주차비공제금    ,
       SUM(NVL(CHOLLAMT   ,0)) 천리안이용료    ,
       SUM(NVL(EDUDEDAMT  ,0)) 교육비공제금    ,
       SUM(NVL(MEDDEDAMT  ,0)) 의료비가불공제금,
       SUM(NVL(DEDAMT1    ,0)) 기타공제1       ,
       SUM(NVL(DEDAMT2    ,0)) 기타공제2       ,
       SUM(NVL(DEDAMT3    ,0)) 기타공제3       ,
       SUM(NVL(DEDAMT4    ,0)) 기타공제4       ,                                
       SUM(NVL(DEDAMT5    ,0)) 기타공제5       , 	     
       SUM(NVL(BONDEDAMT  ,0)) 기지급상여금    ,
       SUM(NVL(PAYHOLDAMT ,0)) 급여압류액      ,
       SUM(NVL(INTAX      ,0)) 소득세          ,
       SUM(NVL(JUTAX      ,0)) 주민세          ,
       SUM(NVL(DEDSUM, 0)) 공제총액            ,
       SUM(REALPAY)        실지급액
 FROM  PKHPHIS
 WHERE PAYDATE  BETWEEN  :From지급년월 AND :To지급년월
   and empno = :사번
 GROUP BY empno, Korname
 
--005.개인별 급여내역(급여이력에서)_1명씩
/* 인수로 조회를 원하는 지급년월 기간을  입력한다.*/
SELECT empno 사번, korname 성명,
       NVL(FIXPAY      ,0) 월정급여       ,
       NVL(QUATERPAY   ,0) 분기급여       ,
       NVL(HOLIPAY     ,0) 명절급여       ,
       NVL(ROLEAMT     ,0) 직책수당       ,
       NVL( MATEAMT    ,0) 가족수당_배우자,
       NVL( PARTAMT    ,0) 가족수당_존속  ,
       NVL( CHILDAMT   ,0) 가족수당_비속  ,
       NVL( LICEAMT    ,0) 자격수당       ,
       NVL( OVTMAMT    ,0) 초과근무수당   ,
       NVL( SPTMAMT    ,0) 특별근무수당   ,
       NVL( AIDAMT1    ,0) 기타수당1      ,
       NVL( AIDAMT2    ,0) 기타수당2      ,
       NVL( AIDAMT3    ,0) "유치수수료(2006년이후)",
       NVL( BONUSAMT   ,0) 정기상여금     ,
       NVL( INCENTAMT  ,0) 능률제고수당   ,
       NVL( TRAINAMT   ,0) 체력단련비     ,
       NVL( WINTERAMT  ,0) 영업인센티브   ,
       NVL( SBONAMT    ,0) 특상           ,
       NVL( MBONAMT    ,0) 월차수당       ,
       NVL( ITAMT      ,0) 정보통신수당   ,/*200501신설*/                  
       NVL( YBONAMT    ,0) 연차           ,
       NVL( MCARAMT    ,0) 식대교통비     ,
       NVL( YUEDUAMT   ,0) 학자금_유치원  ,
       NVL( SELFEDUAMT ,0) 학자금_본인    ,
       NVL( ODAMT      ,0) 운전지원금총액 ,
       NVL( ODTAXAMT   ,0) 운전지원금_과세총액 , 
       NVL( DRVLICEAMT ,0) 운전면허지원금 ,
       NVL( LECTSUPAMT ,0) 사내강사료     ,
       NVL( EDUSUPAMT  ,0) 교육비지원금   ,
       NVL( BOKJISUPAMT,0) 지급복지연금   ,
       NVL( MEDSUPAMT  ,0) 의료비지원금   ,
       NVL( HOMESUPAMT ,0) 선택적복리후생비,
       NVL( LONGSUPAMT ,0) 장기휴가비     ,
       NVL( SUPAMT1    ,0) 기타지원금1    ,
       NVL( SUPAMT2    ,0) 기타지원금2    ,
       NVL( SUPAMT3    ,0) 기타지원금3    ,
       NVL( SOPAYSUM   ,0) 소급급여       ,
       NVL( SOBONSUM   ,0) 소급상여       ,
       NVL( OVMCAMT    ,0) 야근식대       ,
       NVL( CHILDEDUAMT,0) 자녀학자금     ,
       NVL( MEDPAYAMT  ,0) 의료비지원금   ,
       NVL( NOTAXPAY   ,0) 기타비과세급여 ,
       NVL( TAXPAY     ,0) 기타과세급여   ,
       NVL( TRAINSUPAMT,0) 체육활동지원금 ,
       PAYSUM              지급총액        ,
       NVL(SAVEAMT1   ,0) 재형저축        ,
       NVL(SAVEAMT2   ,0) 장기저축        ,
       NVL(SAVEAMT3   ,0) 공제복지연금    ,
       NVL(MEDDAMT    ,0) 건강보험료공제금,
       NVL(EMPLDAMT   ,0) 고용보험료공제금,
       NVL(ANUDAMT    ,0) 국민연금갹출료  ,
       NVL(HSAMT      ,0) 주택자금대출    ,
       NVL(FBAMT      ,0) 외환복지대출    ,
       NVL(NBAMT      ,0) 국제화재대출    ,
       NVL(SACORPAMT  ,0) 사주회사대출    ,
       NVL(SABANKAMT  ,0) 사주은행대출    ,
       NVL(SANGAMT    ,0) 상조회대출      ,
       NVL(LOANAMT1   ,0) 기타대출1       ,
       NVL(LOANAMT2   ,0) 기타대출2       ,
       NVL(LOANAMT3   ,0) 기타대출3       ,
       NVL(TICKETAMT  ,0) 사용식권금액    ,
       NVL(OVMCDED    ,0) 석식공제금      ,
       NVL(NOJOAMT    ,0) 노조회비공제금  ,
       NVL(SAUAMT     ,0) 사우회비공제금  ,
       NVL(IGAMT      ,0) IG회비공제금    ,
       NVL(SOBIAMT    ,0) 소비조합할부금  ,
       NVL(PARKAMT    ,0) 주차비공제금    ,
       NVL(CHOLLAMT   ,0) 천리안이용료    ,
       NVL(EDUDEDAMT  ,0) 교육비공제금    ,
       NVL(MEDDEDAMT  ,0) 의료비가불공제금,
       NVL(DEDAMT1    ,0) 기타공제1       ,
       NVL(DEDAMT2    ,0) 기타공제2       ,
       NVL(DEDAMT3    ,0) 기타공제3       ,
       NVL(DEDAMT4    ,0) 기타공제4       ,
       NVL(DEDAMT5    ,0) 기타공제5       ,
       NVL(BONDEDAMT  ,0) 기지급상여금    ,
       NVL(PAYHOLDAMT ,0) 급여압류액      ,
       NVL(INTAX      ,0) 소득세          ,
       NVL(JUTAX      ,0) 주민세          ,
       NVL(DEDSUM, 0)     공제총액        ,
       REALPAY            실지급액         
 FROM  PKHPHIS                             
 WHERE PAYDATE  BETWEEN  :From지급년월 AND :To지급년월
   and empno =:사번
   
--006.급여통계(급여이력)_전체사원 
/* 급여이력에서 개인별 급여전체항목 통계.*/
SELECT empno 사번, korname 성명, 
       Count(*) 인원,
	   max(codename) 근무지,
       SUM(NVL(FIXPAY      ,0)) 월정급여       ,
       SUM(NVL(QUATERPAY   ,0)) 분기급여       ,
       SUM(NVL(HOLIPAY     ,0)) 명절급여       ,
       SUM(NVL(ROLEAMT     ,0)) 직책수당       ,
       SUM(NVL( MATEAMT    ,0)) 가족수당_배우자,
       SUM(NVL( PARTAMT    ,0)) 가족수당_존속  ,
       SUM(NVL( CHILDAMT   ,0)) 가족수당_비속  ,
       SUM(NVL( LICEAMT    ,0)) 자격수당       ,
       SUM(NVL( OVTMAMT    ,0)) 초과근무수당   ,
       SUM(NVL( SPTMAMT    ,0)) 특별근무수당   ,
       SUM(NVL( AIDAMT1    ,0)) 기타수당1      ,
       SUM(NVL( AIDAMT2    ,0)) 기타수당2      ,
       SUM(NVL( AIDAMT3    ,0)) "유치수수료(2006년이후)",
       SUM(NVL( BONUSAMT   ,0)) 정기상여금     , 
       SUM(NVL( INCENTAMT  ,0)) 능률제고수당   , 
       SUM(NVL( TRAINAMT   ,0)) 체력단련비     , 
       SUM(NVL( WINTERAMT  ,0)) 영업인센티브   ,
       SUM(NVL( SBONAMT    ,0)) 특상           ,
       SUM(NVL( MBONAMT    ,0)) 월차수당       ,
       SUM(NVL( ITAMT      ,0)) 정보통신수당   ,/*200501신설*/
       SUM(NVL( YBONAMT    ,0)) 연차           ,
       SUM(NVL( MCARAMT    ,0)) 식대교통비     ,
       SUM(NVL( MCARTAXAMT ,0)) 식대교통비_과세 ,
       SUM(NVL( YUEDUAMT   ,0)) 학자금_유치원  , 
       SUM(NVL( SELFEDUAMT ,0)) 학자금_본인    ,
       SUM(NVL( ODAMT      ,0)) 운전지원금총액 ,
       SUM(NVL( ODTAXAMT   ,0)) 운전지원금_과세총액 , 
       SUM(NVL( DRVLICEAMT ,0)) 운전면허지원금 ,
       SUM(NVL( LECTSUPAMT ,0)) 사내강사료     ,
       SUM(NVL( EDUSUPAMT  ,0)) 교육비지원금   ,
       SUM(NVL( BOKJISUPAMT,0)) 지급복지연금   ,  
       SUM(NVL( MEDSUPAMT  ,0)) 의료비지원금   ,
       SUM(NVL( HOMESUPAMT ,0)) 선택적복리후생비,
       SUM(NVL( LONGSUPAMT ,0)) 장기휴가비     ,
       SUM(NVL( SUPAMT1    ,0)) 기타지원금1    ,
       SUM(NVL( SUPAMT2    ,0)) 기타지원금2    ,
       SUM(NVL( SUPAMT3    ,0)) 기타지원금3    ,
       SUM(NVL( SOPAYSUM   ,0)) 소급급여       ,
       SUM(NVL( SOBONSUM   ,0)) 소급상여       ,
       SUM(NVL( OVMCAMT    ,0)) 야근식대       ,
       SUM(NVL( CHILDEDUAMT,0)) 자녀학자금     ,
       SUM(NVL( MEDPAYAMT  ,0)) 의료비지원금   ,
       SUM(NVL( NOTAXPAY   ,0)) 기타비과세급여 ,
       SUM(NVL( TAXPAY     ,0)) 기타과세급여   ,
       SUM(NVL( TRAINSUPAMT,0)) 체육활동지원금 ,
       SUM(PAYSUM)             지급총액        ,
       SUM(NVL(SAVEAMT1   ,0)) 재형저축        ,
       SUM(NVL(SAVEAMT2   ,0)) 장기저축        ,
       SUM(NVL(SAVEAMT3   ,0)) 공제복지연금    ,
       SUM(NVL(MEDDAMT    ,0)) 건강보험료공제금,
       SUM(NVL(EMPLDAMT   ,0)) 고용보험료공제금,
       SUM(NVL(ANUDAMT    ,0)) 국민연금갹출료  ,
       SUM(NVL(HSAMT      ,0)) 주택자금대출    ,
       SUM(NVL(FBAMT      ,0)) 외환복지대출    ,
       SUM(NVL(NBAMT      ,0)) 국제화재대출    ,
       SUM(NVL(SACORPAMT  ,0)) 사주회사대출    ,
       SUM(NVL(SABANKAMT  ,0)) 사주은행대출    ,
       SUM(NVL(SANGAMT    ,0)) 상조회대출      ,
       SUM(NVL(LOANAMT1   ,0)) 기타대출1       ,
       SUM(NVL(LOANAMT2   ,0)) 기타대출2       ,
       SUM(NVL(LOANAMT3   ,0)) 기타대출3       ,
       SUM(NVL(TICKETAMT  ,0)) 사용식권금액    ,
       SUM(NVL(OVMCDED    ,0)) 석식공제금      ,
       SUM(NVL(NOJOAMT    ,0)) 노조회비공제금  ,
       SUM(NVL(SAUAMT     ,0)) 사우회비공제금  ,
       SUM(NVL(IGAMT      ,0)) IG회비공제금    ,
       SUM(NVL(SOBIAMT    ,0)) 소비조합할부금  ,
       SUM(NVL(PARKAMT    ,0)) 주차비공제금    ,
       SUM(NVL(CHOLLAMT   ,0)) 천리안이용료    ,
       SUM(NVL(EDUDEDAMT  ,0)) 교육비공제금    ,
       SUM(NVL(MEDDEDAMT  ,0)) 의료비가불공제금,
       SUM(NVL(DEDAMT1    ,0)) 기타공제1       ,
       SUM(NVL(DEDAMT2    ,0)) 기타공제2       ,
       SUM(NVL(DEDAMT3    ,0)) 기타공제3       ,
       SUM(NVL(DEDAMT4    ,0)) 기타공제4       ,                                
       SUM(NVL(DEDAMT5    ,0)) 기타공제5       , 	     
       SUM(NVL(BONDEDAMT  ,0)) 기지급상여금    ,
       SUM(NVL(PAYHOLDAMT ,0)) 급여압류액      ,
       SUM(NVL(INTAX      ,0)) 소득세          ,
       SUM(NVL(JUTAX      ,0)) 주민세          ,
       SUM(NVL(DEDSUM, 0)) 공제총액            ,
       SUM(REALPAY)        실지급액
  FROM PKHPHIS a, pyccode b 
 WHERE PAYDATE  BETWEEN  :From지급년월 AND :To지급년월
   AND codeid='I160' and codeno=BLDCODE  
 GROUP BY empno, Korname
 
--007.급여통계(당월내역)_전체 
/* 당월급여에서 개인별 급여항목내역추출 */
SELECT empno 사번, korname 성명,
      (SELECT CODENAME FROM PYCCODE WHERE CODEID = 'I160' AND CODENO=BLDCODE) 근무지명,
       NVL(FIXPAY     ,0) 월정급여       ,
       NVL(QUATERPAY  ,0) 분기급여       ,
       NVL(HOLIPAY    ,0) 명절급여       ,
       NVL(ROLEAMT    ,0) 직책수당       ,
       NVL(MATEAMT    ,0) 가족수당_배우자,
       NVL(PARTAMT    ,0) 가족수당_존속  ,
       NVL(CHILDAMT   ,0) 가족수당_비속  ,
       NVL(LICEAMT    ,0) 자격수당       ,
       NVL(OVTMAMT    ,0) 초과근무수당   ,
       NVL(SPTMAMT    ,0) 특별근무수당   ,
       NVL(AIDAMT1    ,0) 기타수당1      ,
       NVL(AIDAMT2    ,0) 기타수당2      ,
       NVL(AIDAMT3    ,0) "유치수수료(2006년이후)",
       NVL(BONUSAMT   ,0) 정기상여금     , 
       NVL(INCENTAMT  ,0) 능률제고수당   , 
       NVL(TRAINAMT   ,0) 체력단련비     , 
       NVL(WINTERAMT  ,0) 영업인센티브   ,
       NVL(SBONAMT    ,0) 특상           ,
       NVL(MBONAMT    ,0) 월차수당       ,
       NVL(ITAMT      ,0) 정보통신수당   ,/*200501신설*/
       NVL(YBONAMT    ,0) 연차           ,
       NVL(MCARAMT    ,0) 식대교통비     ,
       NVL(YUEDUAMT   ,0) 학자금_유치원  , 
       NVL(SELFEDUAMT ,0) 학자금_본인    ,
       NVL(ODAMT      ,0) 운전지원금총액 ,
       NVL(ODTAXAMT   ,0) 운전지원금_과세총액 , 
       NVL(DRVLICEAMT ,0) 운전면허지원금 ,
       NVL(LECTSUPAMT ,0) 사내강사료     ,
       NVL(EDUSUPAMT  ,0) 교육비지원금   ,
       NVL(BOKJISUPAMT,0) 지급복지연금   ,  
       NVL(MEDSUPAMT  ,0) 의료비지원금   ,
       NVL(HOMESUPAMT ,0) 선택적복리후생비 ,
       NVL(LONGSUPAMT ,0) 장기휴가비     ,
       NVL(SUPAMT1    ,0) 기타지원금1    ,
       NVL(SUPAMT2    ,0) 기타지원금2    ,
       NVL(SUPAMT3    ,0) 기타지원금3    ,
       NVL(SOPAYSUM   ,0) 소급급여       ,
       NVL(SOBONSUM   ,0) 소급상여       ,
       NVL(OVMCAMT    ,0) 야근식대       ,
       NVL(CHILDEDUAMT,0) 자녀학자금     ,
       NVL(MEDPAYAMT  ,0) 의료비지원금   ,
       NVL(NOTAXPAY   ,0) 기타비과세급여 ,
       NVL(TAXPAY     ,0) 기타과세급여   ,
       NVL(TRAINSUPAMT,0) 체육활동지원금 ,
       PAYSUM              지급총액        ,
       NVL(SAVEAMT1   ,0) 재형저축        ,
       NVL(SAVEAMT2   ,0) 장기저축        ,
       NVL(SAVEAMT3   ,0) 공제복지연금    ,
       NVL(MEDDAMT    ,0) 건강보험료공제금,
       NVL(EMPLDAMT   ,0) 고용보험료공제금,
       NVL(ANUDAMT    ,0) 국민연금갹출료  ,
       NVL(HSAMT      ,0) 주택자금대출    ,
       NVL(FBAMT      ,0) 외환복지대출    ,
       NVL(NBAMT      ,0) 국제화재대출    ,
       NVL(SACORPAMT  ,0) 사주회사대출    ,
       NVL(SABANKAMT  ,0) 사주은행대출    ,
       NVL(SANGAMT    ,0) 상조회대출      ,
       NVL(LOANAMT1   ,0) 기타대출1       ,
       NVL(LOANAMT2   ,0) 기타대출2       ,
       NVL(LOANAMT3   ,0) 기타대출3       ,
       NVL(TICKETAMT  ,0) 사용식권금액    ,
       NVL(OVMCDED    ,0) 석식공제금      ,
       NVL(NOJOAMT    ,0) 노조회비공제금  ,
       NVL(SAUAMT     ,0) 사우회비공제금  ,
       NVL(IGAMT      ,0) IG회비공제금    ,
       NVL(SOBIAMT    ,0) 소비조합할부금  ,
       NVL(PARKAMT    ,0) 주차비공제금    ,
       NVL(CHOLLAMT   ,0) 천리안이용료    ,
       NVL(EDUDEDAMT  ,0) 교육비공제금    ,
       NVL(MEDDEDAMT  ,0) 의료비가불공제금,
       NVL(DEDAMT1    ,0) 기타공제1       ,
       NVL(DEDAMT2    ,0) 기타공제2       ,
       NVL(DEDAMT3    ,0) 기타공제3       ,
       NVL(DEDAMT4    ,0) 기타공제4       ,                                
       NVL(DEDAMT5    ,0) 기타공제5       , 	     
       NVL(BONDEDAMT  ,0) 기지급상여금    ,
       NVL(PAYHOLDAMT ,0) 급여압류액      ,
       NVL(INTAX      ,0) 소득세          ,
       NVL(JUTAX      ,0) 주민세          ,
       NVL(DEDSUM     ,0) 공제총액        ,
       REALPAY        실지급액
 FROM  PKMPCALC
Order By Empno 
 
--008.월급여이력내역_개인별(보고용)
/* 인수로 조회를 원하는 지급년월 기간을  입력한다.*/
SELECT empno 사번, korname 성명, paycl BAND, 
       MAX((select codename from pyccode where codeid = 'I112'   and codeno   = a.paycl   )) BAND명,
	   MAX((select deptname from pycdept where orgnum = a.orgnum and deptcode = a.deptcode)) 부서,	   
       SUM(NVL(FIXPAY      ,0)) 월정급여       ,
       SUM(NVL(QUATERPAY   ,0)) 분기급여       ,
       SUM(NVL(HOLIPAY     ,0)) 명절급여       ,
	   SUM(NVL( SOPAYSUM   ,0)) 소급급여       ,
	   SUM(NVL( SBONAMT    ,0)) 특상           ,
	   SUM(NVL( WINTERAMT  ,0)) 영업인센티브   ,
       SUM(NVL( MCARAMT    ,0)) 식대교통비     ,
	   SUM(NVL( ODAMT      ,0)) 운전지원금총액 ,       
       SUM(NVL(MATEAMT, 0) +
	       NVL(PARTAMT, 0) +
		   NVL(CHILDAMT,0)    ) 가족수당,
       SUM(NVL( LICEAMT    ,0)) 자격수당       ,
       SUM(NVL( OVTMAMT    ,0)) 초과근무수당   ,
       SUM(NVL( SPTMAMT    ,0)) 특별근무수당   ,
       SUM(NVL( AIDAMT1    ,0)) 기타수당1      ,
       SUM(NVL( AIDAMT2    ,0)) 기타수당2      ,
	   SUM(NVL( ITAMT      ,0)) 정보통신수당   ,/*200501신설*/
	   SUM(NVL( YBONAMT    ,0)) 연차           ,
	   SUM(NVL( OVMCAMT    ,0)) 야근식대       ,
	   SUM(NVL( BOKJISUPAMT,0)) 지급복지연금   ,
	   SUM(NVL( YUEDUAMT   ,0)) 학자금_유치원  ,
       SUM(NVL( SELFEDUAMT ,0)) 학자금_본인    ,
	   SUM(NVL( CHILDEDUAMT,0)) 자녀학자금     ,
	   SUM(NVL( LECTSUPAMT ,0)) 사내강사료     ,
       SUM(NVL(EDUSUPAMT   ,0)) 교육비지원금,	
	   SUM(NVL( TRAINSUPAMT,0)) 체육활동지원금 ,       
	   SUM(NVL( MEDPAYAMT  ,0)) 의료비가불금   ,
	   SUM(NVL( MEDSUPAMT  ,0)) 의료비지원금   ,
	   SUM(NVL( HOMESUPAMT ,0)) 선택적복리후생비,
	   SUM(NVL( AIDAMT3    ,0)) 사내유치지원금  ,  /*기타수당3을 사내유치지원금으로 사용*/ 
	   SUM(NVL( TAXPAY     ,0)) 기타과세급여   ,
	   SUM(NVL( NOTAXPAY   ,0)) 기타비과세급여 ,              
       SUM(NVL( PAYSUM     ,0)) 지급총액       ,
       SUM(NVL(INTAX       ,0)) 소득세          ,
       SUM(NVL(JUTAX       ,0)) 주민세          ,
	   SUM(NVL(MEDDAMT     ,0)) 건강보험료공제금,
       SUM(NVL(EMPLDAMT    ,0)) 고용보험료공제금,
       SUM(NVL(ANUDAMT     ,0)) 국민연금갹출료  ,
	   SUM(NVL(SAVEAMT3    ,0)) 공제복지연금    ,       
       SUM(NVL(HSAMT       ,0)) 주택자금대출    ,
	   SUM(NVL(SACORPAMT   ,0)) 사주회사대출    ,
       SUM(NVL(SABANKAMT   ,0)) 사주은행대출    ,
	   SUM(NVL(SANGAMT     ,0)) 상조회대출      ,
	   SUM(NVL(NBAMT       ,0)) 생활안정자금대출이자,
       SUM(NVL(LOANAMT1    ,0)+
	       NVL(LOANAMT2    ,0)+
		   NVL(LOANAMT3    ,0)) 기타대출        ,
       SUM(NVL(TICKETAMT   ,0)) 사용식권금액    ,
	   SUM(NVL(OVMCDED     ,0)) 석식공제금      ,
	   SUM(NVL(NOJOAMT     ,0)) 노조회비공제금  ,
       SUM(NVL(SAUAMT      ,0)) 사우회비공제금  ,
	   SUM(NVL(IGAMT       ,0)) IG회비공제금    ,
       SUM(NVL(PARKAMT     ,0)) 주차비공제금    ,
       SUM(NVL(CHOLLAMT    ,0)) 천리안이용료    ,
	   SUM(NVL(EDUDEDAMT   ,0)) 교육비공제금    ,
       SUM(NVL(MEDDEDAMT   ,0)) 의료비가불공제금,
	   SUM(NVL(PAYHOLDAMT  ,0)) 급여압류액      ,
       SUM(NVL(DEDAMT1     ,0)) 기타공제1       ,
       SUM(NVL(DEDAMT2     ,0)) 기타공제2       ,
       SUM(NVL(DEDAMT3     ,0)) 기타공제3       ,
       SUM(NVL(DEDAMT4     ,0)) 기타공제4       ,
       SUM(NVL(DEDAMT5     ,0)) 기타공제5       ,
       SUM(NVL(BONDEDAMT   ,0)) 기지급상여금    ,	   
       SUM(NVL(DEDSUM      ,0)) 공제총액
  FROM PKHPHIS a
 WHERE PAYDATE  BETWEEN  :From날짜 AND :To날짜
 GROUP BY empno, Korname, a.paycl
 
--009.급여계좌 변동자 추출
select a.empno "사번", a.korname "이름", 
	  (select codename from pyccode where codeid = 'K910' and codeno = a.paybank) "당월급여은행",
	   a.payacnt "당월 급여계좌",
      (select codename from pyccode where codeid = 'K910' and codeno = a.paybank1) "당월식교비은행",
	   a.payacnt1 "당월식교비계좌",
      (select codename from pyccode where codeid = 'K910' and codeno = b.paybank) "전월급여은행",
	   b.payacnt "전월 급여계좌",
      (select codename from pyccode where codeid = 'K910' and codeno = b.paybank1) "전월식교비은행",
	   b.payacnt1 "전월식교비계좌"   
  from pkmpcalc a, 
      (select empno, payacnt, payacnt1, paybank, paybank1 from pkhphis
        where paydate = to_char(add_months(to_date(:paydate,'YYYYMM'),-1),'YYYYMM')) b
 where a.empno = b.empno
   and ( (a.payacnt <> b.payacnt) or (a.payacnt1 <> b.payacnt1) )
 order by a.empno
 
--011.BAND별 지급항목 자료 추출(급여이력추출) 
/* 급여이력에서 직급별 지급항목 통계.(정보검색에 적용) */
SELECT A.PAYCL  BAND                             ,
       MAX((select codename from pyccode where codeid = 'I112'   and codeno   = a.paycl   )) BAND명,
       COUNT(*) 인원                             ,
       SUM(NVL(FIXPAY      ,0)) 월정급여         ,
       SUM(NVL(QUATERPAY   ,0)) 분기급여         ,
       SUM(NVL(HOLIPAY     ,0)) 명절급여         ,
       SUM(NVL(ROLEAMT     ,0)) 직책수당         ,
       SUM(NVL( MATEAMT    ,0)) 가족수당_배우자  ,
       SUM(NVL( PARTAMT    ,0)) 가족수당_존속    ,
       SUM(NVL( CHILDAMT   ,0)) 가족수당_비속    ,
       SUM(NVL( LICEAMT    ,0)) 자격수당         ,
       SUM(NVL( OVTMAMT    ,0)) 초과근무수당     ,
       SUM(NVL( SPTMAMT    ,0)) 특별근무수당     ,
       SUM(NVL( AIDAMT1    ,0)) 기타수당1        ,
       SUM(NVL( AIDAMT2    ,0)) 기타수당2        ,
       SUM(NVL( AIDAMT3    ,0)) "유치수수료(2006년이후)",
       SUM(NVL( BONUSAMT   ,0)) 정기상여금       , 
       SUM(NVL( INCENTAMT  ,0)) 능률제고수당     , 
       SUM(NVL( TRAINAMT   ,0)) 체력단련비       , 
       SUM(NVL( WINTERAMT  ,0)) 영업인센티브     ,
       SUM(NVL( SBONAMT    ,0)) 특상             ,
       SUM(NVL( MBONAMT    ,0)) 월차수당         ,
       SUM(NVL( ITAMT      ,0)) 정보통신수당     ,/*200501신설*/
       SUM(NVL( YBONAMT    ,0)) 연차             ,
       SUM(NVL( MCARAMT    ,0)) 식대교통비       ,
       SUM(NVL( YUEDUAMT   ,0)) 학자금_유치원    , 
       SUM(NVL( SELFEDUAMT ,0)) 학자금_본인      ,
       SUM(NVL( ODAMT      ,0)) 운전지원금총액   ,
       SUM(NVL( DRVLICEAMT ,0)) 운전면허지원금   ,
       SUM(NVL( LECTSUPAMT ,0)) 사내강사료       ,
       SUM(NVL( EDUSUPAMT  ,0)) 교육비지원금     ,
       SUM(NVL( BOKJISUPAMT,0)) 지급복지연금     ,  
       SUM(NVL( MEDSUPAMT  ,0)) 의료비지원금     ,
       SUM(NVL( HOMESUPAMT ,0)) 선택적복리후생비 ,
       SUM(NVL( LONGSUPAMT ,0)) 장기휴가비       ,
       SUM(NVL( SUPAMT1    ,0)) 기타지원금1      ,
       SUM(NVL( SUPAMT2    ,0)) 기타지원금2      ,
       SUM(NVL( SUPAMT3    ,0)) 기타지원금3      ,
       SUM(NVL( SOPAYSUM   ,0)) 소급급여         ,
       SUM(NVL( SOBONSUM   ,0)) 소급상여         ,
       SUM(NVL( OVMCAMT    ,0)) 야근식대         ,
       SUM(NVL( CHILDEDUAMT,0)) 자녀학자금       ,
       SUM(NVL( MEDPAYAMT  ,0)) 의료비지원금     ,
       SUM(NVL( NOTAXPAY   ,0)) 기타비과세급여   ,
       SUM(NVL( TAXPAY     ,0)) 기타과세급여     ,
       SUM(NVL( TRAINSUPAMT,0)) 체육활동지원금   ,
       SUM(PAYSUM)     지급총액                  ,
       SUM(REALPAY)    실지급액
  FROM PKHPHIS A 
 WHERE PAYDATE  BETWEEN  :From지급년월 AND :To지급년월
 GROUP BY A.PAYCL
 
--012.BAND별 급여통계(급여이력추출)           
SELECT A.PAYCL  BAND                             ,
       MAX((select codename from pyccode where codeid = 'I112'   and codeno   = a.paycl   )) BAND명,
       COUNT(*) 인원                           ,
       SUM(NVL(FIXPAY      ,0)) 월정급여       ,
       SUM(NVL(QUATERPAY   ,0)) 분기급여       ,
       SUM(NVL(HOLIPAY     ,0)) 명절급여       ,
       SUM(NVL(ROLEAMT     ,0)) 직책수당       ,
       SUM(NVL( MATEAMT    ,0)) 가족수당_배우자,
       SUM(NVL( PARTAMT    ,0)) 가족수당_존속  ,
       SUM(NVL( CHILDAMT   ,0)) 가족수당_비속  ,
       SUM(NVL( LICEAMT    ,0)) 자격수당       ,
       SUM(NVL( OVTMAMT    ,0)) 초과근무수당   ,
       SUM(NVL( SPTMAMT    ,0)) 특별근무수당   ,
       SUM(NVL( AIDAMT1    ,0)) 기타수당1      ,
       SUM(NVL( AIDAMT2    ,0)) 기타수당2      ,
       SUM(NVL( AIDAMT3    ,0)) "유치수수료(2006년이후)",
       SUM(NVL( BONUSAMT   ,0)) 정기상여금     , 
       SUM(NVL( INCENTAMT  ,0)) 능률제고수당   , 
       SUM(NVL( TRAINAMT   ,0)) 체력단련비     , 
       SUM(NVL( WINTERAMT  ,0)) 영업인센티브   ,
       SUM(NVL( SBONAMT    ,0)) 특상           ,
       SUM(NVL( MBONAMT    ,0)) 월차수당       ,
       SUM(NVL( ITAMT      ,0)) 정보통신수당   ,/*200501신설*/
       SUM(NVL( YBONAMT    ,0)) 연차           ,
       SUM(NVL( MCARAMT    ,0)) 식대교통비     ,
       SUM(NVL( YUEDUAMT   ,0)) 학자금_유치원  , 
       SUM(NVL( SELFEDUAMT ,0)) 학자금_본인    ,
       SUM(NVL( ODAMT      ,0)) 운전지원금총액 ,
       SUM(NVL( ODTAXAMT,0)) 운전지원금_과세총액 , 
       SUM(NVL( DRVLICEAMT ,0)) 운전면허지원금 ,
       SUM(NVL( LECTSUPAMT ,0)) 사내강사료     ,
       SUM(NVL( EDUSUPAMT  ,0)) 교육비지원금   ,
       SUM(NVL( BOKJISUPAMT,0)) 지급복지연금   ,  
       SUM(NVL( MEDSUPAMT  ,0)) 의료비지원금   ,
       SUM(NVL( HOMESUPAMT ,0)) 선택적복리후생비 ,
       SUM(NVL( LONGSUPAMT ,0)) 장기휴가비     ,
       SUM(NVL( SUPAMT1    ,0)) 기타지원금1    ,
       SUM(NVL( SUPAMT2    ,0)) 기타지원금2    ,
       SUM(NVL( SUPAMT3    ,0)) 기타지원금3    ,
       SUM(NVL( SOPAYSUM   ,0)) 소급급여       ,
       SUM(NVL( SOBONSUM   ,0)) 소급상여       ,
       SUM(NVL( OVMCAMT    ,0)) 야근식대       ,
       SUM(NVL( CHILDEDUAMT,0)) 자녀학자금     ,
       SUM(NVL( MEDPAYAMT  ,0)) 의료비지원금   ,
       SUM(NVL( NOTAXPAY   ,0)) 기타비과세급여 ,
       SUM(NVL( TAXPAY     ,0)) 기타과세급여   ,
       SUM(NVL( TRAINSUPAMT,0)) 체육활동지원금 ,
       SUM(PAYSUM)             지급총액        ,
       SUM(NVL(SAVEAMT1   ,0)) 재형저축        ,
       SUM(NVL(SAVEAMT2   ,0)) 장기저축        ,
       SUM(NVL(SAVEAMT3   ,0)) 공제복지연금    ,
       SUM(NVL(MEDDAMT    ,0)) 건강보험료공제금,
       SUM(NVL(EMPLDAMT   ,0)) 고용보험료공제금,
       SUM(NVL(ANUDAMT    ,0)) 국민연금갹출료  ,
       SUM(NVL(HSAMT      ,0)) 주택자금대출    ,
       SUM(NVL(FBAMT      ,0)) 외환복지대출    ,
       SUM(NVL(NBAMT      ,0)) 국제화재대출    ,
       SUM(NVL(SACORPAMT  ,0)) 사주회사대출    ,
       SUM(NVL(SABANKAMT  ,0)) 사주은행대출    ,
       SUM(NVL(SANGAMT    ,0)) 상조회대출      ,
       SUM(NVL(LOANAMT1   ,0)) 기타대출1       ,
       SUM(NVL(LOANAMT2   ,0)) 기타대출2       ,
       SUM(NVL(LOANAMT3   ,0)) 기타대출3       ,
       SUM(NVL(TICKETAMT  ,0)) 사용식권금액    ,
       SUM(NVL(OVMCDED    ,0)) 석식공제금      ,
       SUM(NVL(NOJOAMT    ,0)) 노조회비공제금  ,
       SUM(NVL(SAUAMT     ,0)) 사우회비공제금  ,
       SUM(NVL(IGAMT      ,0)) IG회비공제금    ,
       SUM(NVL(SOBIAMT    ,0)) 소비조합할부금  ,
       SUM(NVL(PARKAMT    ,0)) 주차비공제금    ,
       SUM(NVL(CHOLLAMT   ,0)) 천리안이용료    ,
       SUM(NVL(EDUDEDAMT  ,0)) 교육비공제금    ,
       SUM(NVL(MEDDEDAMT  ,0)) 의료비가불공제금,
       SUM(NVL(DEDAMT1    ,0)) 기타공제1       ,
       SUM(NVL(DEDAMT2    ,0)) 기타공제2       ,
       SUM(NVL(DEDAMT3    ,0)) 기타공제3       ,
       SUM(NVL(DEDAMT4    ,0)) 기타공제4       ,                                
       SUM(NVL(DEDAMT5    ,0)) 기타공제5       , 	     
       SUM(NVL(BONDEDAMT  ,0)) 기지급상여금    ,
       SUM(NVL(PAYHOLDAMT ,0)) 급여압류액      ,
       SUM(NVL(INTAX      ,0)) 소득세          ,
       SUM(NVL(JUTAX      ,0)) 주민세          ,
       SUM(NVL(DEDSUM, 0)) 공제총액            ,
       SUM(REALPAY)        실지급액
 FROM  PKHPHIS A 
 WHERE PAYDATE  BETWEEN  :From지급년월 AND :To지급년월
 GROUP BY A.PAYCL
 
--013.BAND별 급여통계(당월내역추출)
SELECT A.PAYCL  BAND                             ,
       MAX((select codename from pyccode where codeid = 'I112'   and codeno   = a.paycl   )) BAND명,
       COUNT(*) 인원                           ,
       SUM(NVL(FIXPAY      ,0)) 월정급여       ,
       SUM(NVL(QUATERPAY   ,0)) 분기급여       ,
       SUM(NVL(HOLIPAY     ,0)) 명절급여       ,
       SUM(NVL(ROLEAMT     ,0)) 직책수당       ,
       SUM(NVL( MATEAMT    ,0)) 가족수당_배우자,
       SUM(NVL( PARTAMT    ,0)) 가족수당_존속  ,
       SUM(NVL( CHILDAMT   ,0)) 가족수당_비속  ,
       SUM(NVL( LICEAMT    ,0)) 자격수당       ,
       SUM(NVL( OVTMAMT    ,0)) 초과근무수당   ,
       SUM(NVL( SPTMAMT    ,0)) 특별근무수당   ,
       SUM(NVL( AIDAMT1    ,0)) 기타수당1      ,
       SUM(NVL( AIDAMT2    ,0)) 기타수당2      ,
       SUM(NVL( AIDAMT3    ,0)) "유치수수료(2006년이후)",
       SUM(NVL( BONUSAMT   ,0)) 정기상여금     , 
       SUM(NVL( INCENTAMT  ,0)) 능률제고수당   , 
       SUM(NVL( TRAINAMT   ,0)) 체력단련비     , 
       SUM(NVL( WINTERAMT  ,0)) 영업인센티브   ,
       SUM(NVL( SBONAMT    ,0)) 특상           ,
       SUM(NVL( MBONAMT    ,0)) 월차수당       ,
       SUM(NVL( ITAMT      ,0)) 정보통신수당   ,/*200501신설*/
       SUM(NVL( YBONAMT    ,0)) 연차           ,
       SUM(NVL( MCARAMT    ,0)) 식대교통비     ,
       SUM(NVL( YUEDUAMT   ,0)) 학자금_유치원  , 
       SUM(NVL( SELFEDUAMT ,0)) 학자금_본인    ,
       SUM(NVL( ODAMT      ,0)) 운전지원금총액 ,
       SUM(NVL( ODTAXAMT,0)) 운전지원금_과세총액 , 
       SUM(NVL( DRVLICEAMT ,0)) 운전면허지원금 ,
       SUM(NVL( LECTSUPAMT ,0)) 사내강사료     ,
       SUM(NVL( EDUSUPAMT  ,0)) 교육비지원금   ,
       SUM(NVL( BOKJISUPAMT,0)) 지급복지연금   ,  
       SUM(NVL( MEDSUPAMT  ,0)) 의료비지원금   ,
       SUM(NVL( HOMESUPAMT ,0)) 선택적복리후생비 ,
       SUM(NVL( LONGSUPAMT ,0)) 장기휴가비     ,
       SUM(NVL( SUPAMT1    ,0)) 기타지원금1    ,
       SUM(NVL( SUPAMT2    ,0)) 기타지원금2    ,
       SUM(NVL( SUPAMT3    ,0)) 기타지원금3    ,
       SUM(NVL( SOPAYSUM   ,0)) 소급급여       ,
       SUM(NVL( SOBONSUM   ,0)) 소급상여       ,
       SUM(NVL( OVMCAMT    ,0)) 야근식대       ,
       SUM(NVL( CHILDEDUAMT,0)) 자녀학자금     ,
       SUM(NVL( MEDPAYAMT  ,0)) 의료비지원금   ,
       SUM(NVL( NOTAXPAY   ,0)) 기타비과세급여 ,
       SUM(NVL( TAXPAY     ,0)) 기타과세급여   ,
       SUM(NVL( TRAINSUPAMT,0)) 체육활동지원금 ,
       SUM(NVL(ITAMT,0))       정보통신수당,
       SUM(PAYSUM)             지급총액        ,
       SUM(NVL(SAVEAMT1   ,0)) 재형저축        ,
       SUM(NVL(SAVEAMT2   ,0)) 장기저축        ,
       SUM(NVL(SAVEAMT3   ,0)) 공제복지연금    ,
       SUM(NVL(MEDDAMT    ,0)) 건강보험료공제금,
       SUM(NVL(EMPLDAMT   ,0)) 고용보험료공제금,
       SUM(NVL(ANUDAMT    ,0)) 국민연금갹출료  ,
       SUM(NVL(HSAMT      ,0)) 주택자금대출    ,
       SUM(NVL(FBAMT      ,0)) 외환복지대출    ,
       SUM(NVL(NBAMT      ,0)) 국제화재대출    ,
       SUM(NVL(SACORPAMT  ,0)) 사주회사대출    ,
       SUM(NVL(SABANKAMT  ,0)) 사주은행대출    ,
       SUM(NVL(SANGAMT    ,0)) 상조회대출      ,
       SUM(NVL(LOANAMT1   ,0)) 기타대출1       ,
       SUM(NVL(LOANAMT2   ,0)) 기타대출2       ,
       SUM(NVL(LOANAMT3   ,0)) 기타대출3       ,
       SUM(NVL(TICKETAMT  ,0)) 사용식권금액    ,
       SUM(NVL(OVMCDED    ,0)) 석식공제금      ,
       SUM(NVL(NOJOAMT    ,0)) 노조회비공제금  ,
       SUM(NVL(SAUAMT     ,0)) 사우회비공제금  ,
       SUM(NVL(IGAMT      ,0)) IG회비공제금    ,
       SUM(NVL(SOBIAMT    ,0)) 소비조합할부금  ,
       SUM(NVL(PARKAMT    ,0)) 주차비공제금    ,
       SUM(NVL(CHOLLAMT   ,0)) 천리안이용료    ,
       SUM(NVL(EDUDEDAMT  ,0)) 교육비공제금    ,
       SUM(NVL(MEDDEDAMT  ,0)) 의료비가불공제금,
       SUM(NVL(DEDAMT1    ,0)) 기타공제1       ,
       SUM(NVL(DEDAMT2    ,0)) 기타공제2       ,
       SUM(NVL(DEDAMT3    ,0)) 기타공제3       ,
       SUM(NVL(DEDAMT4    ,0)) 기타공제4       ,
       SUM(NVL(DEDAMT5    ,0)) 기타공제5       ,
       SUM(NVL(BONDEDAMT  ,0)) 기지급상여금    ,
       SUM(NVL(PAYHOLDAMT ,0)) 급여압류액      ,
       SUM(NVL(INTAX      ,0)) 소득세          ,
       SUM(NVL(JUTAX      ,0)) 주민세          ,
       SUM(NVL(DEDSUM, 0)) 공제총액            ,
       SUM(REALPAY)        실지급액
 FROM  PKMPCALC A 
 GROUP BY A.PAYCL
 
--014.BAND별/월별 특별근무수당 구하기
/* 인수로 조회를 원하는 지급년도을  입력한다.*/ 
/* 급여이력에서 BAND별 지급항목 통계. */
/* 원하는 년도의 특별근무수당을 BAND별/월별 합계를 구한다. */           
SELECT A.PAYCL  BAND    ,
       MAX((select codename from pyccode where codeid = 'I112'   and codeno   = a.paycl   )) BAND명,
	   count(*) 전체인원,
       NVL(SUM(DECODE(PAYDATE,:YEAR||'01',SPTMAMT)),0) "01월",
	   NVL(SUM(DECODE(PAYDATE,:YEAR||'01',1      )),0) "01월 인원수",
	   NVL(SUM(DECODE(PAYDATE,:YEAR||'02',SPTMAMT)),0) "02월",
	   NVL(SUM(DECODE(PAYDATE,:YEAR||'02',1      )),0) "02월 인원수",
	   NVL(SUM(DECODE(PAYDATE,:YEAR||'03',SPTMAMT)),0) "03월",
	   NVL(SUM(DECODE(PAYDATE,:YEAR||'03',1      )),0) "03월 인원수",
	   NVL(SUM(DECODE(PAYDATE,:YEAR||'04',SPTMAMT)),0) "04월",
	   NVL(SUM(DECODE(PAYDATE,:YEAR||'04',1      )),0) "04월 인원수",
	   NVL(SUM(DECODE(PAYDATE,:YEAR||'05',SPTMAMT)),0) "05월",
	   NVL(SUM(DECODE(PAYDATE,:YEAR||'05',1      )),0) "05월 인원수",
	   NVL(SUM(DECODE(PAYDATE,:YEAR||'06',SPTMAMT)),0) "06월",
	   NVL(SUM(DECODE(PAYDATE,:YEAR||'06',1      )),0) "06월 인원수",
	   NVL(SUM(DECODE(PAYDATE,:YEAR||'07',SPTMAMT)),0) "07월",
	   NVL(SUM(DECODE(PAYDATE,:YEAR||'07',1      )),0) "07월 인원수",
	   NVL(SUM(DECODE(PAYDATE,:YEAR||'08',SPTMAMT)),0) "08월",
	   NVL(SUM(DECODE(PAYDATE,:YEAR||'08',1      )),0) "08월 인원수",
	   NVL(SUM(DECODE(PAYDATE,:YEAR||'09',SPTMAMT)),0) "09월",
	   NVL(SUM(DECODE(PAYDATE,:YEAR||'09',1      )),0) "09월 인원수",
	   NVL(SUM(DECODE(PAYDATE,:YEAR||'10',SPTMAMT)),0) "10월",
	   NVL(SUM(DECODE(PAYDATE,:YEAR||'10',1      )),0) "10월 인원수",
	   NVL(SUM(DECODE(PAYDATE,:YEAR||'11',SPTMAMT)),0) "11월",
	   NVL(SUM(DECODE(PAYDATE,:YEAR||'11',1      )),0) "11월 인원수",
	   NVL(SUM(DECODE(PAYDATE,:YEAR||'12',SPTMAMT)),0) "12월",   
	   NVL(SUM(DECODE(PAYDATE,:YEAR||'12',1      )),0) "12월 인원수"
 FROM  PKHPHIS A 
 WHERE PAYDATE like :YEAR||'%'
   and SPTMAMT > 0
 GROUP BY A.PAYCL
 
--015.BAND별 월급여이력내역(보고용)
/* 인수로 조회를 원하는 지급년월 기간을  입력한다.*/
/* 급여이력에서 개인별 급여전체항목 통계.*/
SELECT DECODE(A.PAYCL, '40', '42', A.PAYCL) BAND코드,
       MAX((select DECODE(CODENAME, '사원', '사원통합', CODENAME) from pyccode
             where codeid = 'I112' and codeno = A.PAYCL))   BAND명,
	   COUNT(*)                 인원수         ,
       SUM(NVL(FIXPAY      ,0)) 월정급여       ,
       SUM(NVL(QUATERPAY   ,0)) 분기급여       ,
       SUM(NVL(HOLIPAY     ,0)) 명절급여       ,
	   SUM(NVL( SOPAYSUM   ,0)) 소급급여       ,
	   SUM(NVL( SBONAMT    ,0)) 특상           ,
	   SUM(NVL( WINTERAMT  ,0)) 영업인센티브   ,
       SUM(NVL( MCARAMT    ,0)) 식대교통비     ,
	   SUM(NVL( ODAMT      ,0)) 운전지원금총액 ,       
       SUM(NVL(MATEAMT     ,0)+
	       NVL(PARTAMT     ,0)+
		   NVL(CHILDAMT    ,0)) 가족수당,
       SUM(NVL( LICEAMT    ,0)) 자격수당       ,
       SUM(NVL( OVTMAMT    ,0)) 초과근무수당   ,
       SUM(NVL( SPTMAMT    ,0)) 특별근무수당   ,
       SUM(NVL( AIDAMT1    ,0)) 기타수당1      ,
       SUM(NVL( AIDAMT2    ,0)) 기타수당2      ,
	   SUM(NVL( ITAMT      ,0)) 정보통신수당   ,/*200501신설*/
	   SUM(NVL( YBONAMT    ,0)) 연차           ,
	   SUM(NVL( OVMCAMT    ,0)) 야근식대       ,
	   SUM(NVL( BOKJISUPAMT,0)) 지급복지연금   ,
	   SUM(NVL( YUEDUAMT   ,0)) 학자금_유치원  ,
       SUM(NVL( SELFEDUAMT ,0)) 학자금_본인    ,
	   SUM(NVL( CHILDEDUAMT,0)) 자녀학자금     ,
	   SUM(NVL( LECTSUPAMT ,0)) 사내강사료     ,
	   SUM(NVL( TRAINSUPAMT,0)) 체육활동지원금 ,       
	   SUM(NVL( MEDPAYAMT  ,0)) 의료비가불금   ,
	   SUM(NVL( MEDSUPAMT  ,0)) 의료비지원금   ,
	   SUM(NVL( HOMESUPAMT ,0)) 선택적복리후생비,
	   SUM(NVL( AIDAMT3    ,0)) 사내유치지원금  ,  /*기타수당3을 사내유치지원금으로 사용*/ 
	   SUM(NVL( TAXPAY     ,0)) 기타과세급여   ,
	   SUM(NVL( NOTAXPAY   ,0)) 기타비과세급여 ,              
       SUM(NVL( PAYSUM     ,0)) 지급총액       ,
       SUM(NVL(INTAX       ,0)) 소득세          ,
       SUM(NVL(JUTAX       ,0)) 주민세          ,
	   SUM(NVL(MEDDAMT     ,0)) 건강보험료공제금,
       SUM(NVL(EMPLDAMT    ,0)) 고용보험료공제금,
       SUM(NVL(ANUDAMT     ,0)) 국민연금갹출료  ,
	   SUM(NVL(SAVEAMT3    ,0)) 공제복지연금    ,       
       SUM(NVL(HSAMT       ,0)) 주택자금대출    ,
	   SUM(NVL(SACORPAMT   ,0)) 사주회사대출    ,
       SUM(NVL(SABANKAMT   ,0)) 사주은행대출    ,
	   SUM(NVL(SANGAMT     ,0)) 상조회대출      ,
	   SUM(NVL(NBAMT       ,0)) 생활안정자금대출이자,
       SUM(NVL(LOANAMT1    ,0)+
	       NVL(LOANAMT2    ,0)+
		   NVL(LOANAMT3    ,0)) 기타대출        ,
       SUM(NVL(TICKETAMT   ,0)) 사용식권금액    ,
	   SUM(NVL(OVMCDED     ,0)) 석식공제금      ,
	   SUM(NVL(NOJOAMT     ,0)) 노조회비공제금  ,
       SUM(NVL(SAUAMT      ,0)) 사우회비공제금  ,
	   SUM(NVL(IGAMT       ,0)) IG회비공제금    ,
       SUM(NVL(PARKAMT     ,0)) 주차비공제금    ,
       SUM(NVL(CHOLLAMT    ,0)) 천리안이용료    ,
	   SUM(NVL(EDUDEDAMT   ,0)) 교육비공제금    ,
       SUM(NVL(MEDDEDAMT   ,0)) 의료비가불공제금,
	   SUM(NVL(PAYHOLDAMT  ,0)) 급여압류액      ,
       SUM(NVL(DEDAMT1     ,0)) 기타공제1       ,
       SUM(NVL(DEDAMT2     ,0)) 기타공제2       ,
       SUM(NVL(DEDAMT3     ,0)) 기타공제3       ,
       SUM(NVL(DEDAMT4     ,0)) 기타공제4       ,
       SUM(NVL(DEDAMT5     ,0)) 기타공제5       ,
       SUM(NVL(BONDEDAMT   ,0)) 기지급상여금    ,	   
       SUM(NVL(DEDSUM      ,0)) 공제총액
  FROM PKHPHIS a
 WHERE PAYDATE  BETWEEN  :From날짜 AND :To날짜
 GROUP BY DECODE(A.PAYCL, '40', '42', A.PAYCL)


--021.정규직 건강보험 당월공제금
SELECT K.EMPNO "사번", K.KORNAME "성명", 
	   (SELECT CODENAME FROM PYCCODE WHERE CODEID = 'I114' AND CODENO =K.PSTATE) "인사상태",
	   M.MEDDEDAMT "건강보험공제금"
  FROM PKMMDDED M, PKMPMAS K
 WHERE K.EMPNO = M.EMPNO
   AND MEDYYMM = (SELECT MAX(MEDYYMM) FROM PKMMDDED)
   AND M.EMPNO NOT LIKE 'Y%'
   
--022.정규직 건강보험 마스터 내역
select k.EMPNO "사번", k.KORNAME "성명",
      (select codename from pyccode where codeid = 'I114' and codeno = k.pstate ) "인사상태" ,
       m.MEDAMT    "건강보험료합계", 
       m.HEALTHAMT "건강보험료", 
       m.LONGMTAMT "장기요양보험료", 
       m.REDUCEAMT "경감보험료", 
       m.REDUCEYN  "경감보험대상여부"
  from PKMMDMAS m, pkmpmas k
 where k.empno = m.empno
   and m.empno not like 'Y%'
   and pstate  <'80'
 order by k.empno

--023.정규직 국민연금 공제이력( 최종이력) 
SELECT ANUYYMM 공제년월, EMPNO "사번",KORNAME "성명",
	   (SELECT CODENAME FROM PYCCODE WHERE CODEID = 'I114'AND CODENO =H.PSTATE) "인사상태",
       ANUDEDAMT "국민연금공제금"
  FROM PKHNPHIS H
 WHERE ANUYYMM = (select max(ANUYYMM) from PKHNPHIS)

--031.저축납입내역 추출(년도별)
select b.empno    사번  , b.korname 성명, 
       a.saveyymm 납입일, a.saveamt 월불입액, 
       SAVEFRDATE 가입일, CANDATE   해지일
  from PKHSVHIS a, PKMSVMAS b
 where saveyymm like :yyyy||'%'
   and a.empno = b.empno
   and a.seqno = b.seqno
 order by 1,3
 
--032.저축가입자 내역조회
Select a.empno   사번, 
       a.korname 성명, 
      (Select codename from pyccode where codeid = 'I114' and codeno = b.pstate  ) 인사상태,
      (Select codename from pyccode where codeid = 'K740' and codeno = a.savekind) 저축구분, 
      (Select codename from pyccode where codeid = 'K910' and codeno = a.savebank) 가입기관,
	   a.savebank 코드,	  
	   a.saveacnt 계좌번호, 
	   a.appdate 신청일, 
      (a.saveperiod||'년'||a.savemonth||'개월') 가입기간,
	   a.savefrdate 개시일Fr, a.savetodate 개시일To,
	   decode(a.gongjekey,0,'개인연금',1,'연금저축',2,'해당없음') 소득공제,
	   a.saveamt1 본인부담금, a.saveamt2 회사부담금, a.saveamt 불입액계,
	   a.endyn   만기여부,
	   a.canyn   해지여부,
	   a.candate 해지일,
	   a.cansayu 해지사유,
	   b.payyn   급여지급여부,
	   a.bigo    비고 
  from PKMSVMAS a, pkmpmas b
 where a.endyn = 'N'
   and b.payyn = 'Y'
   and a.empno = b.empno
 order by a.empno
 
--033.저축가입 내역조회(임원) 
Select a.empno 사번, 
       a.korname 성명, 
	   (Select codename from pyccode
	     where codeid = 'I114' and codeno = b.pstate) 인사상태,
	   (Select codename from pyccode 
	     where codeid = 'K740' and codeno = a.savekind) 저축구분, 
	   (Select codename from pyccode 
	     where codeid = 'K910' and codeno = a.savebank) 가입기관,
	   a.savebank 코드,	  
	   a.saveacnt 계좌번호, 
	   a.appdate 신청일, 
	   (a.saveperiod||'년'||a.savemonth||'개월') 가입기간,
	   a.savefrdate 개시일Fr, a.savetodate 개시일To,
	   decode(a.gongjekey,0,'개인연금',1,'연금저축',2,'해당없음') 소득공제,
	   a.saveamt1 본인부담금, a.saveamt2 회사부담금, a.saveamt 불입액계,
	   a.endyn 만기여부,
	   a.canyn 해지여부,
	   a.candate 해지일,
	   a.cansayu 해지사유,
	   a.bigo 비고 
  from PKMSVMAS a, pimpmas b
 where a.endyn = 'N'
   and a.empno like 'M%'
   and a.empno = b.empno
 order by decode(sign(b.pstate-81),-1,'10',b.pstate), a.empno
 
--041.연말정산 등록내역
-- 연말정산 등록내역 
select EMPNO 사번, KORNAME 성명, JUMINID 주민번호,  TELNO 전화번호, 
       HEADYN 세대주여부, SHEADYN 단독세대주여부, COYN 맞벌이여부, MARRIEDYN 기혼여부, HSOWYN 주택소유여부,  
       MATE 배우자유무, FAMI16NO "6세이하 가족수", FAMI720NO "7~20세가족수", FAMI6064NO "60~64세가족수", 
       FAMI65NO "65세이상",  FAMI70NO "70세이상수", 
       FAMILYNO 총가족수, OBSTACLENO 장애자수, CHILDNO 자녀양육수, WOMAN 부녀자여부, 
       ANUAMT 연금보험료, MEDAMT 의료보험료, HIREAMT 고용보험료, 
       GUARAMT 보장성보험료,  OBSGUARAMT 장애인전용보장성보험,
       GHOSAMT 일반의료비, OHOSAMT 경로의료비, NHOSAMT 장애자의료비,SHOSAMT 본인의료비, 
       SEDUAMT 본인학자금, KEDUNO 유치원수, KEDUAMT 유치원학자금, CEDUBAMT 초중고비속학자금, 
       CEDUBNO 초중고비속인원, CEDUCAMT 초중고형제학자금, CEDUCNO 초중고형제인원,
       UEDUBNO 대학생비속수, UEDUBAMT 대학생비속학자금, UEDUCNO 대학생형제수, UEDUCAMT 대학생형제학자금,
       OBSEDUAMT 장애인특수교육비,   SPECADDNO "결혼.장례.이사 수", 
       HOUSEAMT 주택자금,HLOANAMT 주택차입금공제,  
       HOUSEINTAMT 주택자금차입이자, HOUSEINTAMT2 주택자금이자상환액2,
       AGIVEAMT 전액기부금, PGIVEAMT 일반기부금, SPGIVEAMT 특례지정기부금, POLIAMT 정치기부금,  
       KEDUNO1 영유아보육인원, KEDUAMT1 영유아보육비,  KEDUDED1 영유아보육공제금, 
       PROPAMT1 "재형저축_개인", PROPAMT2 "재형저축_회사", 
       CREDITAMT 신용카드금액,  CREDITDEDAMT 신용카드제외금액, CREDITTOTAMT 신용카드총액, 
       DEBITAMT 직불카드사용액, GIROAMT 지로납부금액, 
	   CASHAMT 현금영수증사용액,
	   COSTOCKAMT 우리사주출연금,
       PENAMT1 "개인연금_개인", PENAMT2 "개인연금_회사", 
       NPENAMT "연금저축_개인", NPENAMT2 "연금저축_회사",  
       MPAYSUM 주급여총액, MBONSUM 주상여총액, MCOGBONSUM 주인정상여, MNOTAX 주비과세,
       MINTAX 주소득세, MJUTAX 주주민세, MNONGTAX 주농특세,	   
       BCORPYN 종근무지근무여부, BCORPNAME 종근무처명, BCORPNO 종근무처사업자번호, 
       BPAYSUM 종급여총액, BBONSUM 종상여총액, 
       BANUAMT 종연금보험료, BMEDAMT 종의료보험료, BHIREAMT 종고용보험료, 
       BINTAX 종소득세, BJUTAX 종주민세, BNONGTAX 종농특세,   
       BCORPNAME1 종근무처명2, BCORPNO1 종사업자번호2, 
       BPAYSUM1 종급여총액2, BBONSUM1 종상여총액, 
       BANUAMT1 종국민연금2, BMEDAMT1 종의료보험료2, BHIREAMT1 종고용보험료2, 
       BINTAX1 종소득세2, BJUTAX1 종주민세2, BNONGTAX1 주농특세2, 
       MGITASODK 기타소득, BNOTAX 종비과세,BCOGBONSUM 종인정상여
  from pkmysapp
  
--042.연말정산마스터 추출
--22.연말정산마스터 추출
select 
      EMPNO 사번, KORNAME 성명, EMPDATE 입사일, HEADYN 세대주여부,  
      LASTMONPAY 최종월정급여, MGITASODK 기타소득, FORITAXGROSS 국외근로소득, 
      MPAYSUM "(주)급여총액", MBONSUM "(주)상여총액",   
      TAXGROSS 과세급여총액, NOTAX 비과세급여총액, MNOTAX "(주)비과세총액", COSTOCKTAX 우리사주인출과세액, 
      BPAYSUM "(종)급여총액", BBONSUM "(종)상여총액", BNOTAX "(종)비과세총액", 
      LABORDED 근로소득공제, LABORAMT 근로소득금액,
      MATE 배우자유무, FAMI16NO "6세이하가족수", FAMI720NO "7~20세가족수", FAMI6064NO "60~64세가족수", 
      FAMI65NO "65세이상가족수", CEDUNO 총중고학생수,  FAMI70NO 경로우대70세이상수, FAMILYNO 총가족수, 
      SELFDED 본인공제, MATEDED 배우자공제, FAMIDED 부양가족공제, BASICDED 기본공제, OBSTACLENO 장애자수,
      KEDUNO1 영유아보육인원, KEDUAMT1 영유아보육비, KEDUDED1 영유아보육공제금, 
      CHILDNO 자녀양육수, WOMAN 부녀자여부, OLDDED 경로우대공제, OBSDED 장애자공제, WOMANDED 부녀자공제, 
      CHILDDED 자녀양육공제, APPENDDED 추가공제, FEWNO 소수추가공제, FEWDED 소수추가공제, 
      MEDAMT  의료보험료, MEDDED 의료보험료공제,   BMEDAMT "(종)의료보험료",
      HIREAMT 고용보험료, HIREDED 고용보험료공제,  BHIREAMT "(종)고용보험료",
      GUARAMT 보장성보험료, GUARDED 보장성보험료공제,  INSDED 보험료공제, 
      OBSGUARAMT 장애인전용보장성보험, OBSGUARDED 장애인전용보험공제액,       
      ANUAMT 연금보험료, BANUAMT "종1_연금보험료", BANUAMT1 "종2_연금보험료", ANUDED 연금보험료공제액, 
      SHOSAMT 본인의료비, GHOSAMT 일반의료비, OHOSAMT 경로의료비, NHOSAMT 장애자의료비, HOSAMT 의료비, HOSDED 의료비공제, 
      SEDUAMT 본인학자금, SEDUDED 본인학자금공제, KEDUNO 유치원수, KEDUAMT 유치원학자금, KEDUDED 유치원학자금공제, 
      CEDUAMT 초중고학자금, CEDUDED 초중고학자금공제, UEDUNO 대학생수, UEDUAMT 대학생학자금, UEDUDED 대학생학자금공제, 
      OBSEDUNO 장애인교육인원, OBSEDUAMT 장애인교육비, OBSEDUDED 장애인교육공제액, EDUDED 학자금공제, 
      SPECADDNO 결혼장례건수, SPECADDDED 결혼장례공제, 
      HOUSEAMT  주택자금, HOUSEDED 주택자금공제, HOUSEINTAMT 주택저장차입이자, HOUSEINTAMT2 주택자금이자상환액2, 
      NOHOUSEDED 무주택자공제,  HLOANAMT 주택차입금공제, HLOANDED 주택차입금공제, 
      AGIVEAMT 전액기부금, AGIVEDED 전액기부금, PGIVEAMT 일반기부금, PGIVEDED 일반기부금, SGIVEAMT 사립학교기부금, 
      POLIAMT 정치기부금, SPGIVAMT 특례기부금, SPGIVDED 특례기부공제액, GIVEDED 기부금공제,  
      SPECIALDED 특별공제,  STANDDED 표준공제,  
      PENAMT1 "개인연금(개인)", PENAMT2 "개인연금(회사)", BPENAMT "(종)개인연금", PENDED 개인연금공제, 
      NPENAMT "연금저축_개인", NPENAMT2 "연금저축_회사", NPENDED 연금저축공제액, 
      COSTOCKAMT 우리사주조합출연, COSTOCKDED 우리사주조합원공제, 
      DEBITAMT 직불카드사용액, GIROAMT 지로용지납부액, CASHAMT 현금영수증사용액,
      CREDITDEDAMT 신용카드제외금액, CREDITTOTAMT 신용카드신청금액, CREDITAMT 신용카드금액, CREDITDED 신용카드공제, 
      PROPAMT1 재형저축, PROPAMT2 재형저축, PROPDED 재형저축공제,  BPROPAMT "(종)재형저축",  
      STKAMT 주식저축공제, STKDED 주식저축공제, FORIAMT 외국납부공제, FORIDED 외국납부공제, 
      INVESTAMT 투자조합출자소득금액, INVESTDED 투자조합출자소득공제금액, 
      INCOMEDED 종합소득공제계, TAXLEVEL 과세표준, CALCTAX 산출세액, 
      INCOMTDED 근로소득세액공제, POLIDED 정치기부금세액공제, 
      ETCTAMT 기타세액감면, ETCTDED 기타세액감면, TDEDSUM 세액감면총액, 
      DINTAX 결정소득세, DJUTAX 결정주민세, DNONGTAX 결정농특세, 
      MINTAX "(주)소득세", MJUTAX "(주)주민세", MNONGTAX "(주)농특세", 
      BINTAX "(종)소득세", BJUTAX "(종)주민세", BNONGTAX "(종)농특세", 
      INTAX "(주종)소득세", JUTAX "(주종)주민세", NONGTAX "(주종)농특세", 
      YINTAX 차감소득세, YJUTAX 차감주민세, YNONGTAX 차감농특세, YCALCTAX 차감정산액,  FINALPAY 최종지급금액, 
      MCRESUM "주_3개월과세급여", BCRESUM "종_3개월급여", BCORPNAME1 "종2_근무지명", BCORPNO1 "종2_사업자번호", 
      BPAYSUM1 "종2_급여총액", BBONSUM1 "종2_상여총액", BMEDAMT1 "종2_의료보험료", BHIREAMT1 "종_고용보험료", 
      BINTAX1 "종2_소득세", BJUTAX1 "종2_주민세", BNONGTAX1 "종_농특세", 
      MCOGBONSUM "주_인정상여", BCOGBONSUM "종_인정상여", 
      LSTKAMT 장기증권, LSTKDED 장기증권공제액, 
      FOREIGNAMT 외국인자녀교육비, FOREIGNDED 외국인자녀교육비공제액
 from pkmysmas 
 
--043.연말정산이력 추출
select 
      EMPNO 사번, KORNAME 성명, EMPDATE 입사일, HEADYN 세대주여부,  
      LASTMONPAY 최종월정급여, MGITASODK 기타소득, FORITAXGROSS 국외근로소득, 
      MPAYSUM "(주)급여총액", MBONSUM "(주)상여총액",   
      TAXGROSS 과세급여총액, NOTAX 비과세급여총액, MNOTAX "(주)비과세총액", COSTOCKTAX 우리사주인출과세액, 
      BPAYSUM "(종)급여총액", BBONSUM "(종)상여총액", BNOTAX "(종)비과세총액", 
      LABORDED 근로소득공제, LABORAMT 근로소득금액,
      MATE 배우자유무, FAMI16NO "6세이하가족수", FAMI720NO "7~20세가족수", FAMI6064NO "60~64세가족수", 
      FAMI65NO "65세이상가족수", CEDUNO 총중고학생수,  FAMI70NO 경로우대70세이상수, FAMILYNO 총가족수, 
      SELFDED 본인공제, MATEDED 배우자공제, FAMIDED 부양가족공제, BASICDED 기본공제, OBSTACLENO 장애자수,
      KEDUNO1 영유아보육인원, KEDUAMT1 영유아보육비, KEDUDED1 영유아보육공제금, 
      CHILDNO 자녀양육수, WOMAN 부녀자여부, OLDDED 경로우대공제, OBSDED 장애자공제, WOMANDED 부녀자공제, 
      CHILDDED 자녀양육공제, APPENDDED 추가공제, FEWNO 소수추가공제, FEWDED 소수추가공제, 
      MEDAMT  의료보험료, MEDDED 의료보험료공제,   BMEDAMT "(종)의료보험료",
      HIREAMT 고용보험료, HIREDED 고용보험료공제,  BHIREAMT "(종)고용보험료",
      GUARAMT 보장성보험료, GUARDED 보장성보험료공제,  INSDED 보험료공제, 
      OBSGUARAMT 장애인전용보장성보험, OBSGUARDED 장애인전용보험공제액,       
      ANUAMT 연금보험료, BANUAMT "종1_연금보험료", BANUAMT1 "종2_연금보험료", ANUDED 연금보험료공제액, 
      SHOSAMT 본인의료비, GHOSAMT 일반의료비, OHOSAMT 경로의료비, NHOSAMT 장애자의료비, HOSAMT 의료비, HOSDED 의료비공제, 
      SEDUAMT 본인학자금, SEDUDED 본인학자금공제, KEDUNO 유치원수, KEDUAMT 유치원학자금, KEDUDED 유치원학자금공제, 
      CEDUAMT 초중고학자금, CEDUDED 초중고학자금공제, UEDUNO 대학생수, UEDUAMT 대학생학자금, UEDUDED 대학생학자금공제, 
      OBSEDUNO 장애인교육인원, OBSEDUAMT 장애인교육비, OBSEDUDED 장애인교육공제액, EDUDED 학자금공제, 
      SPECADDNO 결혼장례건수, SPECADDDED 결혼장례공제, 
      HOUSEAMT  주택자금, HOUSEDED 주택자금공제, HOUSEINTAMT 주택저장차입이자, HOUSEINTAMT2 주택자금이자상환액2, 
      NOHOUSEDED 무주택자공제,  HLOANAMT 주택차입금공제, HLOANDED 주택차입금공제, 
      AGIVEAMT 전액기부금, AGIVEDED 전액기부금, PGIVEAMT 일반기부금, PGIVEDED 일반기부금, SGIVEAMT 사립학교기부금, 
      POLIAMT 정치기부금, SPGIVAMT 특례기부금, SPGIVDED 특례기부공제액, GIVEDED 기부금공제,  
      SPECIALDED 특별공제,  STANDDED 표준공제,  
      PENAMT1 "개인연금(개인)", PENAMT2 "개인연금(회사)", BPENAMT "(종)개인연금", PENDED 개인연금공제, 
      NPENAMT "연금저축_개인", NPENAMT2 "연금저축_회사", NPENDED 연금저축공제액, 
      COSTOCKAMT 우리사주조합출연, COSTOCKDED 우리사주조합원공제, 
      DEBITAMT 직불카드사용액, GIROAMT 지로용지납부액, CASHAMT 현금영수증사용액,
      CREDITDEDAMT 신용카드제외금액, CREDITTOTAMT 신용카드신청금액, CREDITAMT 신용카드금액, CREDITDED 신용카드공제, 
      PROPAMT1 재형저축, PROPAMT2 재형저축, PROPDED 재형저축공제,  BPROPAMT "(종)재형저축",  
      STKAMT 주식저축공제, STKDED 주식저축공제, FORIAMT 외국납부공제, FORIDED 외국납부공제, 
      INVESTAMT 투자조합출자소득금액, INVESTDED 투자조합출자소득공제금액, 
      INCOMEDED 종합소득공제계, TAXLEVEL 과세표준, CALCTAX 산출세액, 
      INCOMTDED 근로소득세액공제, POLIDED 정치기부금세액공제, 
      ETCTAMT 기타세액감면, ETCTDED 기타세액감면, TDEDSUM 세액감면총액, 
      DINTAX 결정소득세, DJUTAX 결정주민세, DNONGTAX 결정농특세, 
      MINTAX "(주)소득세", MJUTAX "(주)주민세", MNONGTAX "(주)농특세", 
      BINTAX "(종)소득세", BJUTAX "(종)주민세", BNONGTAX "(종)농특세", 
      INTAX "(주종)소득세", JUTAX "(주종)주민세", NONGTAX "(주종)농특세", 
      YINTAX 차감소득세, YJUTAX 차감주민세, YNONGTAX 차감농특세, YCALCTAX 차감정산액,  FINALPAY 최종지급금액, 
      MCRESUM "주_3개월과세급여", BCRESUM "종_3개월급여", BCORPNAME1 "종2_근무지명", BCORPNO1 "종2_사업자번호", 
      BPAYSUM1 "종2_급여총액", BBONSUM1 "종2_상여총액", BMEDAMT1 "종2_의료보험료", BHIREAMT1 "종_고용보험료", 
      BINTAX1 "종2_소득세", BJUTAX1 "종2_주민세", BNONGTAX1 "종_농특세", 
      MCOGBONSUM "주_인정상여", BCOGBONSUM "종_인정상여", 
      LSTKAMT 장기증권, LSTKDED 장기증권공제액, 
      FOREIGNAMT 외국인자녀교육비, FOREIGNDED 외국인자녀교육비공제액
 from pkhyshis 
where workyy = :yyyy






select distinct groupname from AQUSERQUERY

select GROUPNAME,QUERYNAME
  from AQUSERQUERY
 where groupname='01.급여-퇴직'
 order by 1,2
 